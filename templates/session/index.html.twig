{% extends 'base.html.twig' %}

{% block title %}Sessions
{% endblock %}

{% block additional_css %}
	<link rel="stylesheet" href="{{ asset('css/session.css') }}">
{% endblock %}

{% block body %}

	<h1>Sessions</h1>

	{# Affiche la liste des sessions #}
	{% if session is null %}


		{# <a href="{{ path('new_session') }}">Ajouter une sesion</a> #}

		<h2>Les sessions</h2>

		<h3>Sessions en cours</h3>
		<table>
			<thead>
				<th>Formation</th>
				<th>Nombre de place</th>
				<th>Date de début</th>
				<th>Date de fin</th>
			</thead>
			<tbody>
				{% for session in enCours %}
					<tr class="clickable-row" data-url="{{ path('infos_session', {'id': session.id}) }}">
						<td>
							{{ session.formation }}</td>
						<td>
							{{ session.nbPlace }}</td>
						<td>
							{{ session.dateDebut|date("d/m/Y") }}</td>
						<td>
							{{ session.dateFin|date("d/m/Y") }}</td>
						{# <p>Nombre de stagiaire : {{ session.stagiaire }}</p> #}
						{# <p>Nombre de programme : {{ session.programme }}</p> #}
					</tr>
				{% endfor %}
			</tbody>
		</table>

		<h3>Sessions terminées</h3>
		<table>
			<thead>
				<th>Formation</th>
				<th>Nombre de place</th>
				<th>Date de début</th>
				<th>Date de fin</th>
			</thead>
			<tbody>
				{% for session in terminees %}
					<tr class="clickable-row" data-url="{{ path('infos_session', {'id': session.id}) }}">
						<td>
							{{ session.formation }}</td>
						<td>
							{{ session.nbPlace }}</td>
						<td>
							{{ session.dateDebut|date("d/m/Y") }}</td>
						<td>
							{{ session.dateFin|date("d/m/Y") }}</td>
						{# <p>Nombre de stagiaire : {{ session.stagiaire }}</p> #}
						{# <p>Nombre de programme : {{ session.programme }}</p> #}
					</tr>
				{% endfor %}
			</tbody>
		</table>

		<h3>Sessions à venir</h3>
		<table>
			<thead>
				<th>Formation</th>
				<th>Nombre de place</th>
				<th>Date de début</th>
				<th>Date de fin</th>
			</thead>
			<tbody>
				{% for session in future %}
					<tr class="clickable-row" data-url="{{ path('infos_session', {'id': session.id}) }}">
						<td>
							{{ session.formation }}</td>
						<td>
							{{ session.nbPlace }}</td>
						<td>
							{{ session.dateDebut|date("d/m/Y") }}</td>
						<td>
							{{ session.dateFin|date("d/m/Y") }}</td>
						{# <p>Nombre de stagiaire : {{ session.stagiaire }}</p> #}
						{# <p>Nombre de programme : {{ session.programme }}</p> #}
					</tr>
				{% endfor %}
			</tbody>
		</table>

		{# Affiche l'information d'une seule session #}
	{% else %}
		<a href="{{ path('app_session') }}">Retour</a>
		<h2>Information de la session</h2>
		<p>Formation :
			<a href="{{ path('infos_formation', {'id': session.formation.id}) }}" target="_blank">{{ session.formation }}</a>
		</p>
		<p>Date de début :
			{{ session.dateDebut |format_datetime(pattern='d MMMM y', locale='fr') }}</p>
		<p>Date de fin :
			{{ session.dateFin |format_datetime(pattern='d MMMM y', locale='fr') }}</p>
		<p>Nombre de place :
			{{ session.nbPlace }}</p>

		{# Liste des stagiaires #}
		<h3>Liste des stagiaires inscrits</h3>
		{% if session.stagiaires is empty %}
			<p>Aucun stagiaire inscrits</p>
		{% else %}
			{% for stagiaire in session.stagiaires %}
				<p>
					<a href="{{ path('infos_stagiaire', {'id': stagiaire.id}) }}" target="_blank">{{ stagiaire.nom }}
						{{ stagiaire.prenom }}</a>
					<a class="confirm-delete" href="{{ path('deleteStagiaire_session', {'id': session.id, 'idStagiaire': stagiaire.id}) }}">Supprimer</a>
				</p>
			{% endfor %}
		{% endif %}

		<h3>Programme</h3>
		{% if session.programmes is empty %}
			<p>Cette session n'a pas de programme</p>
		{% else %}
			{% for key, programme in session.programmes %}
				<p>{{ key + 1 }}:
					<a href="{{ path('infos_module', {'id': programme.module.id }) }}" target="_blank">{{ programme.module }}</a>
					/
					{{ programme.nbJour }}
					jours
					<a class="confirm-delete" href="{{ path('deleteProgramme_session', {'id' : session.id, 'idProgramme': programme.id}) }}">Supprimer</a>
				</p>
			{% endfor %}
		{% endif %}


	{% endif %}

	{# JavaScript #}
	{% block additional_javascripts %}
		<script src="{{ asset('js/session.js') }}"></script>
	{% endblock %}

{% endblock %}
